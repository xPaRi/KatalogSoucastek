(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{oK7c:function(t,e,n){"use strict";n.r(e),n.d(e,"SettingModule",function(){return W});var i=n("ADsi"),c=n("tyNb"),o=n("fXoL");let s=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:2,vars:0,template:function(t,e){1&t&&(o.Tb(0,"div"),o.Gc(1," \u653e\u4ec0\u4e48\uff1f\n"),o.Sb())},styles:[""]}),t})();var r=n("mkZv"),a=n("YMfE"),p=n("sYmb"),l=n("kmnG"),b=n("d3UM"),g=n("3Pt+"),u=n("ofXK"),d=n("FKr1");function h(t,e){if(1&t&&(o.Tb(0,"mat-option",4),o.Gc(1),o.Sb()),2&t){const t=e.$implicit;o.kc("value",t.key),o.Bb(1),o.Ic(" ",t.value," ")}}let m=(()=>{class t{constructor(t){this.translate=t,this.langSelected=Object(a.n)(),this.langOption=r.m}selectLang(t){Object(a.v)(t),this.translate.use(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(p.d))},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:7,vars:5,consts:[[1,"option-box"],[1,"label"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(o.Tb(0,"div",0),o.Tb(1,"div",1),o.Gc(2),o.gc(3,"translate"),o.Sb(),o.Tb(4,"mat-form-field"),o.Tb(5,"mat-select",2),o.bc("ngModelChange",function(t){return e.langSelected=t})("ngModelChange",function(t){return e.selectLang(t)}),o.Ec(6,h,2,2,"mat-option",3),o.Sb(),o.Sb(),o.Sb()),2&t&&(o.Bb(2),o.Ic(" ",o.hc(3,3,"SETTING.SW_LANG")," "),o.Bb(3),o.kc("ngModel",e.langSelected),o.Bb(1),o.kc("ngForOf",e.langOption))},directives:[l.b,b.a,g.l,g.n,u.j,d.l],pipes:[p.c],styles:[".option-box[_ngcontent-%COMP%]{margin-bottom:1rem}"]}),t})();var f=n("mrSG"),v=n("XNiG"),S=n("1G5W"),w=n("cgZG"),y=n("0IaG"),C=n("bTqV");function O(t,e){if(1&t&&(o.Tb(0,"mat-option",7),o.Gc(1),o.gc(2,"translate"),o.Sb()),2&t){const t=e.$implicit,n=o.fc();o.kc("value",t.number),o.Bb(1),o.Jc(" No.",t.number+1," - ",o.hc(2,3,n.getScriptName(t))," ")}}let T=(()=>{class t{constructor(t,e){this.data=t,this._dialogRef=e,this.result=0,this.result=t.code}ngOnInit(){}confirm(){const{result:t}=this,{scripts:e}=this.data,n=e.find(e=>e.number===t);this._dialogRef.close(n)}getScriptName(t){return""===t.values[0]?"\u672a\u547d\u540d":t.values[0]}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(y.a),o.Nb(y.g))},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:14,vars:11,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","","matDialogClose",""],["mat-button","","cdkFocusInitial","",3,"click"],[3,"value"]],template:function(t,e){1&t&&(o.Tb(0,"h1",0),o.Gc(1),o.gc(2,"translate"),o.Sb(),o.Tb(3,"div",1),o.Tb(4,"mat-form-field"),o.Tb(5,"mat-select",2),o.bc("ngModelChange",function(t){return e.result=t}),o.Ec(6,O,3,5,"mat-option",3),o.Sb(),o.Sb(),o.Sb(),o.Tb(7,"div",4),o.Tb(8,"button",5),o.Gc(9),o.gc(10,"translate"),o.Sb(),o.Tb(11,"button",6),o.bc("click",function(){return e.confirm()}),o.Gc(12),o.gc(13,"translate"),o.Sb(),o.Sb()),2&t&&(o.Bb(1),o.Hc(o.hc(2,5,"WARN.IMPORT_SCRIPT")),o.Bb(4),o.kc("ngModel",e.result),o.Bb(1),o.kc("ngForOf",null==e.data?null:e.data.scripts),o.Bb(3),o.Hc(o.hc(10,7,"COMMON.CANCEL")),o.Bb(3),o.Ic(" ",o.hc(13,9,"COMMON.CONFIRM")," "))},directives:[y.h,y.e,l.b,b.a,g.l,g.n,u.j,y.c,C.a,y.d,d.l],pipes:[p.c],styles:[""]}),t})();var _=n("8SIa"),M=n("jMnz"),k=n("tk/3");let P=(()=>{class t{constructor(t,e){this.api=t,this.http=e}install(){const t=Object.assign({},r.p.record.install);return this.http.post(this.api,t)}uninstall(){const t=Object.assign({},r.p.record.uninstall);return this.http.post(this.api,t)}listener(){const t=Object.assign({},r.p.record.listener);return this.http.post(this.api,t)}}return t.\u0275fac=function(e){return new(e||t)(o.Xb(M.a),o.Xb(k.b))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var G=n("JxTr"),I=n("WTUP"),N=n("dNgK"),B=n("XiUz"),L=n("NFeN");function D(t,e){if(1&t){const t=o.Ub();o.Tb(0,"button",11),o.bc("click",function(){return o.tc(t),o.fc().start()}),o.Tb(1,"mat-icon"),o.Gc(2,"play_arrow"),o.Sb(),o.Sb()}}function x(t,e){if(1&t){const t=o.Ub();o.Tb(0,"button",12),o.bc("click",function(){return o.tc(t),o.fc().stop()}),o.Tb(1,"mat-icon"),o.Gc(2,"stop"),o.Sb(),o.Sb()}}function E(t,e){1&t&&(o.Tb(0,"mat-icon",19),o.Gc(1,"vertical_align_top"),o.Sb())}function j(t,e){1&t&&(o.Tb(0,"mat-icon",20),o.Gc(1,"vertical_align_bottom"),o.Sb())}function R(t,e){1&t&&(o.Rb(0),o.Tb(1,"mat-icon",21),o.Gc(2,"workspaces"),o.Sb(),o.Qb())}function U(t,e){if(1&t&&(o.Rb(0),o.Gc(1),o.Qb()),2&t){const t=o.fc().$implicit;o.Bb(1),o.Ic(" ",t.delay," ms ")}}function F(t,e){if(1&t&&(o.Tb(0,"div",13),o.Tb(1,"div",14),o.Ec(2,E,2,0,"mat-icon",15),o.Ec(3,j,2,0,"mat-icon",16),o.Gc(4),o.Sb(),o.Tb(5,"div",17),o.Ec(6,R,3,0,"ng-container",18),o.Ec(7,U,2,1,"ng-container",18),o.Sb(),o.Sb()),2&t){const t=e.$implicit;o.Bb(2),o.kc("ngIf","Up"===t.action),o.Bb(1),o.kc("ngIf","Down"===t.action),o.Bb(1),o.Ic(" ",null==t?null:t.name," "),o.Bb(2),o.kc("ngIf",-1===t.delay),o.Bb(1),o.kc("ngIf",-1!==t.delay)}}var A=function(t){return t[t.Down=0]="Down",t[t.Up=128]="Up",t}({}),H=function(t){return t[t.Combination=0]="Combination",t[t.General=1]="General",t}({});let $=(()=>{class t{constructor(t,e,n,i,c,o){this.deviceService=t,this.recordService=e,this.scriptService=n,this.loadService=i,this._dialog=c,this._snakeBar=o,this.rowsCounter=0,this.stepCounter=0,this.alive=!1,this.stepList=[],this.destory$=new v.a,this.timer=Date.now(),t.device$.pipe(Object(S.a)(this.destory$)).subscribe(t=>{t&&(this.device=t,n.getScripts(t.session).pipe(Object(S.a)(this.destory$)).subscribe(t=>{this.scripts=t.data}))})}ngOnInit(){this.scrollContainer=document.querySelector(".record-step-wrapper")}ngOnDestroy(){this.alive&&this.stop(),this.destory$.next(),this.destory$.complete()}start(){return Object(f.a)(this,void 0,void 0,function*(){this.rowsCounter=0,this.stepCounter=0,this.stepList=[],this.recordService.install().subscribe(t=>{this.listener(),this.alive=!0})})}stop(){return Object(f.a)(this,void 0,void 0,function*(){this.loadService.loading(),this.alive=!1,yield this.recordService.uninstall().toPromise(),this.stepList.length>0&&(this.stepList[this.stepList.length-1].delay=35,this.stepCounter+=2),this._snakeBar.open("Has stopped recording!"),this.loadService.complete()})}listener(){this.stepCounter>=997?this.stop():this.recordService.listener().subscribe(t=>{var e;if(!this.alive)return;if(-1===t.status)return void this.stop();const n=Date.now()-this.timer;if(this.timer=Date.now(),this.rowsCounter++,(null===(e=this.stepList)||void 0===e?void 0:e.length)>0){const t=n>=256?3:2;this.stepList[this.stepList.length-1].delay=n,this.stepCounter+=t}const i=this.createStep(t,-1);this.stepList.push(i),this.scrollContainer.scrollTop=this.scrollContainer.scrollHeight,this.listener()})}save(){this._dialog.open(w.c,{data:r.g}).afterClosed().subscribe(t=>{if(t){const e=this.createResult();Object(a.h)(e,t.content)}})}openSelectScript(){return Object(f.a)(this,void 0,void 0,function*(){const{device:t,scripts:e}=this;if(t){const{session:n}=t,i=(yield this.scriptService.getScripts(t.session).toPromise()).data.find(t=>1===t.code);this._dialog.open(T,{data:{scripts:e,code:i.code},width:"600px"}).afterClosed().subscribe(e=>Object(f.a)(this,void 0,void 0,function*(){if(e){this.loadService.loading();const c=Object.assign(Object.assign({},e),{code:1});yield this.scriptService.switchScript(n,[c]).toPromise();const o=this.createResult();yield this.scriptService.writeScriptSteps(t.session,o).toPromise(),yield this.scriptService.switchScript(n,[i]).toPromise(),yield this.deviceService.writeConfig(n).toPromise(),this.alive=!1,this.stepList=[],this._snakeBar.open("Save Successful!"),this.loadService.complete()}}))}else this._snakeBar.open("Please connect device!")})}get canAction(){return!this.alive&&this.stepList.length>0}createStep(t,e){const{key_code:n,key_type:i,key_flags:c}=t;let o={name:"1",delay:e,action:"",origin:t};switch(i){case H.General:o.name=this.getNameByOpts(r.r,n);break;case H.Combination:o.name=this.getNameByOpts(r.t,n)}switch(c){case A.Down:o.action="Down";break;case A.Up:o.action="Up"}return o}getNameByOpts(t,e){const n=t.find(t=>t.code===e);return n?n.name:""}createResult(){let t=0;const{stepList:e}=this;return e.map(e=>{const{delay:n}=e,{key_code:i,key_type:c,key_flags:o}=e.origin;let s=[];const r=this.getKeyType(c,o);if(s[0]=this.parseToIns(i,t++,r),n>=256){const e=Math.floor(n/256),i=n%256;s[1]=this.parseToIns(e,t++,"DelayL"),s[2]=this.parseToIns(i,t++,"Delay")}else s[1]=this.parseToIns(n,t++,"Delay");return s}).reduce((t,e)=>t.concat(e))}getKeyType(t,e){return t===H.Combination?e===A.Down?"CombinationDown":"CombinationUp":e===A.Down?"GeneralDown":"GeneralUp"}parseToIns(t,e,n){return{code:{CombinationDown:16,CombinationUp:24,GeneralDown:17,GeneralUp:25,Delay:6,DelayL:5}[n],number:e,values:[t,0,0,0]}}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(_.a),o.Nb(P),o.Nb(G.a),o.Nb(I.a),o.Nb(y.b),o.Nb(N.b))},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:23,vars:16,consts:[[1,"setting-page-wrapper"],["fxLayout","column",1,"record-action-wrapper"],["mat-fab","","color","primary",3,"click",4,"ngIf"],["color","primary","mat-fab","",3,"click",4,"ngIf"],["color","primary","mat-fab","",3,"disabled","click"],[1,"record-step-container"],[1,"record-step-wrapper"],["fxLayout","row","fxLayoutAlign","space-between center","class","step-wrapper",4,"ngFor","ngForOf"],[1,"hint"],[1,"row-counter"],[1,"step-counter"],["mat-fab","","color","primary",3,"click"],["color","primary","mat-fab","",3,"click"],["fxLayout","row","fxLayoutAlign","space-between center",1,"step-wrapper"],["fxLayout","row","fxLayoutAlign","center center",1,"name"],["class","up",4,"ngIf"],["class","down",4,"ngIf"],[1,"delay"],[4,"ngIf"],[1,"up"],[1,"down"],[1,"wait-icon"]],template:function(t,e){1&t&&(o.Tb(0,"div",0),o.Tb(1,"div",1),o.Ec(2,D,3,0,"button",2),o.Ec(3,x,3,0,"button",3),o.Tb(4,"button",4),o.bc("click",function(){return e.save()}),o.Tb(5,"mat-icon"),o.Gc(6,"download"),o.Sb(),o.Sb(),o.Tb(7,"button",4),o.bc("click",function(){return e.openSelectScript()}),o.Tb(8,"mat-icon"),o.Gc(9,"create"),o.Sb(),o.Sb(),o.Sb(),o.Tb(10,"div",5),o.Tb(11,"div",6),o.Ec(12,F,8,5,"div",7),o.Sb(),o.Tb(13,"div",8),o.Tb(14,"span",9),o.Gc(15),o.gc(16,"translate"),o.Sb(),o.Tb(17,"span",10),o.Gc(18),o.gc(19,"translate"),o.Sb(),o.Tb(20,"span"),o.Gc(21),o.gc(22,"translate"),o.Sb(),o.Sb(),o.Sb(),o.Sb()),2&t&&(o.Bb(2),o.kc("ngIf",!e.alive),o.Bb(1),o.kc("ngIf",e.alive),o.Bb(1),o.kc("disabled",!e.canAction),o.Bb(3),o.kc("disabled",!e.canAction),o.Bb(5),o.kc("ngForOf",e.stepList),o.Bb(3),o.Jc("",o.hc(16,10,"\u884c\u6570"),"\uff1a",e.rowsCounter,""),o.Bb(3),o.Jc("",o.hc(19,12,"\u6b65\u9aa4\u6570"),"\uff1a",e.stepCounter,""),o.Bb(3),o.Ic("( Tip: ",o.hc(22,14,"WARN.MAX_STEP_COUNTER")," )"))},directives:[B.b,u.k,C.a,L.a,u.j,B.a],pipes:[p.c],styles:[".setting-page-wrapper[_ngcontent-%COMP%]{position:relative;display:flex}.setting-page-wrapper[_ngcontent-%COMP%]   .record-action-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px}.setting-page-wrapper[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;place-items:center;line-height:1.75;height:36px;color:#d2d2d2;font-size:12px}.setting-page-wrapper[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .record-step-container[_ngcontent-%COMP%]{flex:1;margin:0 1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .record-step-container[_ngcontent-%COMP%]   .record-step-wrapper[_ngcontent-%COMP%]{position:relative;background:#2b3135;border-radius:5px;height:700px;overflow:auto;padding:.5rem}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]{height:30px;padding:0 1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon.down[_ngcontent-%COMP%]{color:red}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon.up[_ngcontent-%COMP%]{color:green}.wait-icon[_ngcontent-%COMP%]{transform:rotate(0);animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(1turn)}}"]}),t})();var K=n("0wH7");const J=[{path:"",component:(()=>{class t{constructor(){this.settingNav=[{name:"SETTING.PREFERENCE",url:"preference",icon:"room_preferences"},{name:"SETTING.RECORD",url:"record",icon:"videocam"}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:3,vars:1,consts:[[3,"navList"],[1,"setting-container"]],template:function(t,e){1&t&&(o.Ob(0,"sayo-nav",0),o.Tb(1,"div",1),o.Ob(2,"router-outlet"),o.Sb()),2&t&&o.kc("navList",e.settingNav)},directives:[K.a,c.g],styles:[".setting-container[_ngcontent-%COMP%]{padding:3rem 6rem}"]}),t})(),children:[{path:"",redirectTo:"preference"},{path:"preference",component:m},{path:"record",component:$},{path:"about",component:s}]}];let X=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(J)],c.f]}),t})(),W=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},imports:[[i.a,X]]}),t})()}}]);